library(data.table)
misspelling=readLines("/Users/daxinggao/Desktop/misspelling.txt",warn=F)

mislist=NULL
for(i in 1:length(misspelling)){
  if(grepl("\\$",misspelling[i])){
    name=misspelling[i]
  }
  else {mislist=c(mislist,misspelling[i])
  names(mislist)[length(mislist)]=name}
}
names(mislist)=tolower(gsub("\\$","",names(mislist)))
mislist=tolower(mislist)

mgsub=function(p,r,x){
  for(i in 1:length(r)){
    x=gsub(p[i],r[i],x)
  }
  return(x)
}

correctmis=function(x){
  mgsub(mislist,names(mislist),x)
}

uni=fread("uni.csv")
b=correctmis(uni$name)
uni=aggregate(Frequency~name,uni,FUN=sum)
uniorder=uni[order(uni$Frequency,decreasing=T),]

bi=fread("bi.csv")
bi$name=correctmis(bi$name)
bi=aggregate(Frequency~name,bi,FUN=sum)
biorder=bi[order(bi$Frequency,decreasing=T),]
